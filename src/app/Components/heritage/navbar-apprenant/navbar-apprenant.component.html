<nav class="navbar navbar-expand-lg  fixed-top">
    <div class="container-fluid">
      <!-- Bouton du menu toggle placé à gauche avec icône blanche sans encadrement -->
      <button class="navbar-toggler me-2" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasNavbar" aria-controls="offcanvasNavbar">
        <span class="navbar-toggler-icon"></span>
      </button>
      <!-- Logo à gauche -->
      <a class="navbar-brand" href="#">
        <img src="../../../../assets/images/logo.png" alt="logo" class="img-fluid">
      </a>

      <div class="offcanvas offcanvas-start" tabindex="-1" id="offcanvasNavbar" aria-labelledby="offcanvasNavbarLabel">
        <!-- <div class="offcanvas-header">
          <h5 class="offcanvas-title" id="offcanvasNavbarLabel">
              <img src="../../../../assets/images/logo.png" alt="profil">
          </h5>
           <p class="nom-profil">Serigne Fallou Niang</p>
        </div> -->
        <div class="offcanvas-header">
          <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close">
            <!-- <i id="menu-icon" class="fas fa-bars"></i> -->
          </button>
        </div>


        <div class="offcanvas-body">
          <ul class="navbar-nav">
            <li class="nav-item">
              <a class="nav-link active"  (click)="navigateToAccueil()" routerLink="/accueil" routerLinkActive="active-link" aria-current="page">Accueil</a>
            </li>
            <li class="nav-item">
              <a class="nav-link active" aria-current="page"  (click)="navigateToHistorique()" routerLinkActive="active-link">Historique</a>
            </li>
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
               Catégories
              </a>
              <ul class="dropdown-menu custom-dropdown fade">
                <li><a (click)="onCategoryClick(categorie.id!)"  class="dropdown-item"  *ngFor="let categorie of tabCategorie; trackBy: trackByCategorieId" routerLinkActive="active-link">{{categorie.name}}</a></li>
              </ul>
            </li>
            <li class="nav-item" *ngIf="!userConnected">
              <button class="connexion" (click)="navigateToLogin()">
                  <svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M2.44444 22C1.77222 22 1.19696 21.7609 0.718667 21.2826C0.24037 20.8043 0.000814815 20.2286 0 19.5556V2.44444C0 1.77222 0.239556 1.19696 0.718667 0.718667C1.19778 0.24037 1.77304 0.000814815 2.44444 0H11V2.44444H2.44444V19.5556H11V22H2.44444ZM15.8889 17.1111L14.2083 15.3389L17.325 12.2222H7.33333V9.77778H17.325L14.2083 6.66111L15.8889 4.88889L22 11L15.8889 17.1111Z" fill="#FFD233"/>
                    </svg>
                    Connexion
              </button>
            </li>
            <li class="nav-item dropdown connexionIcone" *ngIf="userConnected">
              <a class="nav-link dropdown-toggle d-flex align-items-center" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                <svg width="40" height="40" viewBox="0 0 60 60" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M11.6289 48.75C11.6289 48.75 18.75 48.75 22.5 45" stroke="#FFD233" stroke-width="3.75" stroke-linecap="round" stroke-linejoin="round"/>
                  <path d="M22.5 45C22.5 45 26.25 48.75 30 48.75" stroke="#FFD233" stroke-width="3.75" stroke-linecap="round" stroke-linejoin="round"/>
                  <path d="M48.3711 48.75C48.3711 48.75 41.25 48.75 37.5 45" stroke="#FFD233" stroke-width="3.75" stroke-linecap="round" stroke-linejoin="round"/>
                  <path d="M37.5 45C37.5 45 33.75 48.75 30 48.75" stroke="#FFD233" stroke-width="3.75" stroke-linecap="round" stroke-linejoin="round"/>
                  <path d="M30 11.2502C37.5 11.2502 41.25 15.0002 41.25 26.2502C41.25 35.6251 33.75 41.2501 30 41.2501" stroke="#FFD233" stroke-width="3.75" stroke-linecap="round" stroke-linejoin="round"/>
                  <path d="M29.9999 11.2502C22.5 11.2502 18.75 15.0002 18.75 26.2502C18.75 35.6251 26.25 41.2501 30 41.2501" stroke="#FFD233" stroke-width="3.75" stroke-linecap="round" stroke-linejoin="round"/>
                  <path d="M37.5001 45L35.762 38.5132" stroke="#FFD233" stroke-width="3.75" stroke-linecap="round" stroke-linejoin="round"/>
                  <path d="M22.5 45L24.2381 38.5132" stroke="#FFD233" stroke-width="3.75" stroke-linecap="round" stroke-linejoin="round"/>
                  <path d="M30 56.2498C44.4974 56.2498 56.2498 44.4974 56.2498 30C56.2498 15.5027 44.4974 3.75024 30 3.75024C15.5027 3.75024 3.75024 15.5027 3.75024 30C3.75024 44.4974 15.5027 56.2498 30 56.2498Z" stroke="#FFD233" stroke-width="3.75" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <span class="ms-2">{{ userConnected.name }}</span>
              </a>
              <ul class="dropdown-menu custom-dropdown">
                <li><a class="dropdown-item" (click)="openEditProfileModal()">Modifier profil</a></li>
                <li><hr class="dropdown-divider"></li>
                <li><a class="dropdown-item" (click)="logout()">Déconnexion</a></li>
              </ul>
            </li>
          </ul>

          <!-- <div class="offcanvas-footer">
             <h2 class="" data-bs-dismiss="offcanvas" >Fermer</h2>
            </div> -->

        </div>
      </div>
    </div>
  </nav>



  <!-- Modal de modification de profile -->
  <div *ngIf="showEditProfileModal && userConnected" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Modifier le profil</h2>
        <button class="close-button" (click)="closeEditProfileModal()">&times;</button>
      </div>
      <div class="modal-body">
        <!-- Profile Form -->
        <form (ngSubmit)="updateProfile()">
          <div class="form-group">
            <label for="name">Nom</label>
            <input type="text" [(ngModel)]="userConnected.name" id="name" name="name" required>
          </div>
          <div class="form-group">
            <label for="email">Email</label>
            <input type="email" [(ngModel)]="userConnected.email" id="email" name="email" required>
          </div>
          <div class="form-group">
            <label for="telephone">Téléphone</label>
            <input type="tel" [(ngModel)]="userConnected.telephone" id="telephone" name="telephone">
          </div>
          <div class="form-group">
            <label for="locale">Langue</label>
            <select [(ngModel)]="userConnected.locale" id="locale" name="locale">
              <option value="fr">Français</option>
              <option value="en">Anglais</option>
              <option value="ar">Arabe</option>
              <option value="wo">Wolof</option>
            </select>
          </div>
          <div class="form-actions">
            <button type="submit" class="btn-primary">Enregistrer les modifications</button>
            <button type="button" class="btn-secondary" (click)="closeEditProfileModal()">Annuler</button>
          </div>
        </form>
      </div>
    </div>
  </div>